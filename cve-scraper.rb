#!/usr/bin/env ruby

require 'nokogiri'
require 'net/http'
require 'uri'

keyword = ARGV[0] # Yes yes security whatever not for production etc.

unless keyword && keyword.strip
  puts "You need a keyword. Try your favorite company."
  exit(1)
end

uri = URI.parse("https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=#{keyword}")
res = Net::HTTP.get_response(uri)

doc = Nokogiri.HTML(res.body)

cve_table = doc.search('table')[2].search('tr')

cve_table.each do |line|
  cve_id = line.search('td')[0]
  next unless cve_id
  cve_desc = line.search('td')[1]
  next unless cve_desc
  puts %Q{"#{cve_id.text.strip}","#{cve_desc.text.strip}"}
end



